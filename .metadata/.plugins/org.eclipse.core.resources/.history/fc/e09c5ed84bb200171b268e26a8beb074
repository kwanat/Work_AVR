// Created by: KAMIL WANAT
// uC: Attiny 24
// dostêpne porty: PA0-7, PB0-3
// port przycisku: PB0
// porty wyjsciowe: PA0-7



#include <avr/io.h>
# include <util/delay.h>

//makra uzytkownika
#define il_migniec 8
#define czas_migniecia 40
#define czas_calosci 11

//makra sprzetowe
#define LED1 (1<<PA0)
#define LED2 (1<<PA1)
#define LED3 (1<<PA2)
#define LED4 (1<<PA3)
#define LED5 (1<<PA4)
#define LED6 (1<<PA5)
#define KEY (1<<PB0)
#define PORTLED PORTA
#define DDRLED DDRA
#define PORTLED1 PORTB
#define DDRLED1 DDRB
#define PINKEY PINB
#define PORTKEY PORTB

#define odstepshort 5
#define odsteplong czas_migniecia-(2*odstepshort)
int main()
{
	uint8_t key_lock;
	DDRLED =0xFF;
	PORTKEY |= KEY;
	_delay_ms(10);
	while(1)
	{
		if( !key_lock && !(PINKEY & KEY))
		{
			key_lock=1;
			//reakcja na wcisniecie klawisza
			for(int j=0;j<czas_calosci;j++)
			{
				PORTLED|=(LED1)|(LED3)|(LED5);
				for(int i=0;i<il_migniec;i++)
				{
					PORTLED ^= (LED1);
					_delay_ms(odstepshort);
					PORTLED ^= (LED3);
					_delay_ms(odstepshort);
					PORTLED ^= (LED5);
					_delay_ms(odsteplong);
				}
				PORTLED&=(!LED1)&(!LED3)&(!LED5);
				PORTLED|=(LED2)|(LED4)|(LED6);
				for(int i=0;i<il_migniec;i++)
				{
					PORTLED ^= (LED2);
					_delay_ms(odstepshort);
					PORTLED ^= (LED4);
					_delay_ms(odstepshort);
					PORTLED ^= (LED6);
					_delay_ms(odsteplong);
				}
				PORTLED&=(!LED2)&(!LED4)&(!LED6);
			}
		}else if(key_lock && (PINKEY &KEY)) key_lock++;
	}
	return 0;
}
